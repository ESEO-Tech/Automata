window.namespace=function(a,b,c){"use strict";"string"==typeof a&&(c=b,b=a,a=window);var d=a;return b.split(".").forEach(function(a){"undefined"==typeof d[a]&&(d[a]={}),d=d[a]}),c&&c(d,a),d},namespace("automata",function(a){"use strict";a.main=function(a){$(function(){function b(){e.scale(),f.updateViewbox()}function c(){switch(window.location.hash){case"#export":$("#control-view .export").attr("href",h.toBlobURL())[0].click();break;case"#import":$("#control-view .import").change(function(){h.fromFile(this.files[0])}).click();break;case"#to-base64":alert(h.toBase64());break;default:window.location.hash.match(/^#from-base64:/)?h.fromBase64(window.location.hash.slice(13)):console.log("Invalid hash")}}var d=a.world.create().init(),e=(a.view.create().init(d,$("#world-view")),automata.view.TransitionTable.create().init(d.stateMachine,$("#table-view"))),f=(automata.view.ControlView.create().init(d,$("#control-view")),automata.view.Diagram.create().init(d.stateMachine,$("#diagram-view"))),g=automata.view.HelpView.create().init(d,$("#help-view"));automata.view.ScoreView.create().init(d,$("#score-view"));b(),$(window).resize(b);var h=automata.storage.LocalStorage.create().init().addSource(a.key+".model",d.stateMachine).addSource(a.key+".view.table",e).addSource(a.key+".view.diagram",f),i=h.load();c(),$(window).on("hashchange",c),i||g.show()})}}),Object.create||!function(){"use strict";function a(){}Object.create=function(b){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}(),namespace("automata.model",function(a,b){"use strict";var c=0;a.Object={init:function(){return this.listeners={},this.id=String(c),c++,this},create:function(a){return Object.create(this).augment(a||{})},get proto(){return Object.getPrototypeOf(this)},augment:function(a){for(var b in a)this[b]=a[b];return this},toStorable:function(){return{}},fromStorable:function(a){return this},addListener:function(a,b,c){return a in this.listeners||(this.listeners[a]=[]),this.listeners[a].push(this.makeListenerRecord(a,b,c)),this},removeListener:function(a,b,c){if(a in this.listeners)for(var d=this.listeners[a],e=this.makeListenerRecord(a,b,c),f=0,g=d.length;g>f;)d[f].callback===e.callback&&d[f].receiver===e.receiver?(d.splice(f,1),g--):f++;return this},fire:function(a){if(a in this.listeners){var b=this.listeners[a],c=Array.prototype.slice.call(arguments,1);c.unshift(this);for(var d=0,e=b.length;e>d;d++){var f=b[d];f.callback.apply(f.receiver,c)}}return this},makeListenerRecord:function(a,c,d){return"undefined"==typeof d?"function"==typeof c?{callback:c,receiver:b}:{callback:c[a],receiver:c}:{callback:c,receiver:d}}}}),namespace("automata.view",function(a){"use strict";a.View=automata.model.Object.create({templates:{},init:function(a,b){return automata.model.Object.init.call(this),this.model=a,b&&(this.container=b),this.render(),this},render:function(){},renderTemplate:function(a,b){return nunjucks.render(this.templates[a],b)}})}),namespace("automata.model",function(a){"use strict";a.State=a.Object.create({init:function(b){a.Object.init.call(this);var c=this.id;do this.name="State"+c,c++;while(b.states.some(function(a){return a.name===this.name},this));return this.stateMachine=b,this.encoding=b.getStateVars().map(function(){return"0"}),this.outgoingTransitions=[],this.incomingTransitions=[],this},toStorable:function(){return{name:this.name,encoding:this.encoding}},fromStorable:function(a){return this.name=a.name,this.encoding=a.encoding,this.fire("changed"),this},destroy:function(){for(;this.outgoingTransitions.length;)this.stateMachine.removeTransition(this.outgoingTransitions[0]);for(;this.incomingTransitions.length;)this.stateMachine.removeTransition(this.incomingTransitions[0]);return this},setName:function(a){return this.name=a,this.fire("changed"),this},setEncoding:function(a,b){return this.encoding[a]=b,this.fire("changed"),this},addOutgoingTransition:function(a){return this.outgoingTransitions.push(a),this},removeOutgoingTransition:function(a){var b=this.outgoingTransitions.indexOf(a);return this.outgoingTransitions.splice(b,1),this},addIncomingTransition:function(a){this.incomingTransitions.push(a)},removeIncomingTransition:function(a){var b=this.incomingTransitions.indexOf(a);return this.incomingTransitions.splice(b,1),this},getTransitionsToState:function(a){return this.outgoingTransitions.filter(function(b){return b.targetState===a})},getMooreActions:function(){return this.outgoingTransitions.length?this.stateMachine.world.actuators.filter(function(a,b){return this.outgoingTransitions.every(function(a){return"1"===a.outputs[b]})||this.outgoingTransitions.some(function(a){return"1"===a.outputs[b]&&a.inputs.every(function(a){return"-"===a})})},this).map(function(a){return a.name},this):[]},getTransitionToFire:function(){for(var a=0,b=this.outgoingTransitions.length;b>a;a++){var c=this.outgoingTransitions[a];if(c.canFire())return c}return null}})}),namespace("automata.model",function(a){"use strict";a.Transition=a.Object.create({init:function(b,c){a.Object.init.call(this),this.sourceState=b,this.targetState=c;var d=b.stateMachine.world;return this.inputs=d.sensors.map(function(){return"-"}),this.outputs=d.actuators.map(function(){return"0"}),b.addOutgoingTransition(this),c.addIncomingTransition(this),this},toStorable:function(){return{sourceStateId:this.sourceState.id,targetStateId:this.targetState.id,inputs:this.inputs,outputs:this.outputs}},fromStorable:function(a){return this.inputs=a.inputs,this.outputs=a.outputs,this.fire("changed"),this},destroy:function(){this.sourceState.removeOutgoingTransition(this),this.targetState.removeIncomingTransition(this)},setInput:function(a,b){return this.inputs[a]=b,this.fire("changed"),this},setOutput:function(a,b){return this.outputs[a]=b,this.fire("changed"),this},setTargetState:function(a){return this.targetState.removeIncomingTransition(this),a.addIncomingTransition(this),this.targetState=a,this.fire("changed"),this},getIndex:function(){return this.sourceState.outgoingTransitions.indexOf(this)},matchesPattern:function(a){for(var b=0,c=Math.min(this.inputs.length,a.length);c>b;b++)if("-"!==this.inputs[b]&&"-"!==a[b]&&this.inputs[b]!==a[b])return!1;return!0},canFire:function(){return this.matchesPattern(this.sourceState.stateMachine.world.sensorValues)},isNonDeterministic:function(){return this.sourceState.outgoingTransitions.some(function(a){return a!==this&&this.matchesPattern(a.inputs)&&(this.targetState!==a.targetState||this.outputs.some(function(b,c){return b!==a.outputs[c]}))},this)}})}),namespace("automata.model",function(a){"use strict";a.StateMachine=a.Object.create({init:function(b){return a.Object.init.call(this),this.world=b,this.states=[],this.statesById={},this.transitions=[],this.transitionsById={},this.reset(),this},toStorable:function(){var a={states:{},transitions:{}};for(var b in this.statesById)a.states[b]=this.statesById[b].toStorable();for(var c in this.transitionsById)a.transitions[c]=this.transitionsById[c].toStorable();return a},fromStorable:function(a,b){for(var c in a.states)b[c]=this.createState().fromStorable(a.states[c]);for(var d in a.transitions){var e=a.transitions[d];b[d]=this.createTransition(b[e.sourceStateId],b[e.targetStateId]).fromStorable(e)}return this},getStateVars:function(){return this.world.solution&&this.world.solution.stateVars?this.world.solution.stateVars:[]},createState:function(){var b=a.State.create().init(this);return this.states.push(b),this.statesById[b.id]=b,b.addListener("changed",function(){this.fire("changed")},this),this.fire("createState",b),this.fire("changed"),b},removeState:function(a){this.fire("beforeRemoveState",a);var b=this.states.indexOf(a);return 0===b&&this.world.stop(),a.destroy(),this.states.splice(b,1),delete this.statesById[a.id],this.fire("afterRemoveState",a),this.fire("changed"),this},createTransition:function(b,c){var d=a.Transition.create().init(b,c);return this.transitions.push(d),this.transitionsById[d.id]=d,d.addListener("changed",function(){this.fire("changed")},this),this.fire("createTransition",d),this.fire("changed"),d},removeTransition:function(a){return this.fire("beforeRemoveTransition",a),a.destroy(),this.transitions.splice(this.transitions.indexOf(a),1),delete this.transitionsById[a.id],this.fire("afterRemoveTransition",a),this.fire("changed"),this},reset:function(){this.states.length?this.currentState=this.states[0]:this.currentState=null,this.fire("currentStateChanged",this.currentState)},step:function(){var a=this.currentState.getTransitionToFire();return a?(this.currentState=a.targetState,a.sourceState!==a.targetState&&this.fire("currentStateChanged",this.currentState),a.outputs):this.world.actuators.map(function(){return"0"})}})}),namespace("automata.model",function(a,b){"use strict";a.World=a.Object.create({timeStepMin:1,timeStepMax:1e3,timeStep:20,sensors:[],actuators:[],init:function(){return a.Object.init.call(this),this.stateMachine=a.StateMachine.create().init(this),this.reset(),this},reset:function(){this.sensorValues=this.sensors.map(function(){return"0"}),this.actuatorValues=this.actuators.map(function(){return"0"}),this.stateMachine.reset(),this.onReset(),this.fire("changed")},onReset:function(){},getSensorValue:function(a){return this.sensorValues[a]},setSensorValue:function(a,b){return this.sensorValues[a]=b,this},getActuatorValue:function(a){return this.actuatorValues[a]},setActuatorValue:function(a,b){return this.actuatorValues[a]=b,this},start:function(){(!this.stateMachine.currentState||this.getStatus().done)&&this.reset(),this.stateMachine.currentState&&(this.isRunning=!0,this.fire("start"),this.step(this.timeStep))},step:function(a){for(;a>=this.timeStep&&this.isRunning;){this.actuatorValues=this.stateMachine.step(),this.onStep();var c=this.getStatus();c.done&&(this.pause(),this.fire("done",c)),a-=this.timeStep}if(this.fire("changed"),this.isRunning){var d=Date.now(),e=this;this.clock=b.setTimeout(function(){e.step(Date.now()-d+a)},this.timeStep)}},pause:function(){this.isRunning=!1,b.clearTimeout(this.clock),this.fire("pause")},stop:function(){this.isRunning=!1,b.clearTimeout(this.clock),this.reset(),this.fire("stop")},getStatus:function(){return{done:!1}},onStep:function(){}})}),namespace("automata.view",function(a){"use strict";a.TransitionTable=a.View.create().augment({templates:{main:"templates/TransitionTable-main.tpl.html",state:"templates/TransitionTable-state.tpl.html",transition:"templates/TransitionTable-transition.tpl.html"},init:function(b,c){return a.View.init.call(this,b,c),b.addListener("createState",this).addListener("afterRemoveState",this).addListener("createTransition",this).addListener("beforeRemoveTransition",this).addListener("afterRemoveTransition",this).addListener("currentStateChanged",this),this.zoom=1,this},render:function(){this.root=$(this.renderTemplate("main",this.model)).appendTo(this.container);var a=this.model;$("button",this.root).click(function(){a.createState()})},scale:function(){var a=$(".source-state-name input[type=text]",this.root),b=-1;a.each(function(){(0>b||$(this).val().length>b)&&(b=$(this).val().length)}),a.attr("size",Math.max(4,b));var c=this.container.scrollTop()/this.zoom;this.root.css("transform","none"),this.zoom=this.container.innerWidth()/this.root.width(),this.root.css("transform","scale("+this.zoom+")"),this.container.scrollTop(c*this.zoom)},scrollTo:function(a){var b=a.position().top,c=a.last().position().top+a.last().height(),d=this.container.scrollTop(),e=this.container.height();0>b||c-b>e?this.container.scrollTop(d+b):c>e&&this.container.scrollTop(d+c-e)},createState:function(a,b){b.addListener("changed",this.updateState,this),$("td.target-state-name select",this.root).each(function(){$("<option>").val(b.id).text(b.name).insertBefore($("option:last()",$(this)))});var c=$(this.renderTemplate("state",{state:b,model:a})).insertBefore($("tr",this.root).last());$("td.remove-state button",c).click(function(){a.removeState(b)}),$("td.source-state-name input[type=text]",c).change(function(){b.setName($(this).val())}),$("td.create-transition button",c).click(function(){a.createTransition(b,b)}),$("table.state-encoding input",c).each(function(a){$(this).click(function(){var c="0"===$(this).val()?"1":"0";b.setEncoding(a,c)})}),this.scale(),this.scrollTo(c),$("input[type=text]",c).focus()},getRowsForState:function(a){return $("tr.state-"+a.id,this.root)},afterRemoveState:function(a,b){this.getRowsForState(b).remove(),$("option[value='"+b.id+"']",this.root).remove(),this.scale()},updateState:function(a){var b=this.getRowsForState(a);$("td.source-state-name input[type=text]",b).val(a.name),$("table.state-encoding input",b).each(function(b){$(this).val(a.encoding[b])}),$("option[value='"+a.id+"']",this.root).text(a.name),this.scale(),this.scrollTo(b)},createTransition:function(a,b){var c=b.sourceState;b.addListener("changed",this.updateTransition,this);var d=this.getRowsForState(c),e=d.last(),f=$("td.create-transition",e);f.after(this.renderTemplate("transition",{transition:b,model:a})),$("td.remove-transition button",e).click(function(){a.removeTransition(b)}),$("td.transition-input input",e).each(function(a){$(this).click(function(){var c="0";switch($(this).val()){case"0":c="1";break;case"1":c="-";break;case"-":c="0"}b.setInput(a,c)})}),$("td.transition-output input",e).each(function(a){$(this).click(function(){var c="0"===$(this).val()?"1":"0";b.setOutput(a,c)})}),$("td.target-state-name select",e).change(function(){var c=$(this).val();"#NewState#"===c&&(c=a.createState().id),b.setTargetState(a.statesById[c])}),$("<tr>").addClass("state-"+c.id).append(f).insertAfter(e),$("td.remove-state, td.source-state-name",d).attr("rowspan",d.length+1),this.showNonDeterministicTransitions(b.sourceState),this.scale(),this.scrollTo(e)},updateTransition:function(a){var b=a.getIndex(),c=this.getRowsForState(a.sourceState).slice(b,b+1);$("td.transition-input input",c).each(function(b){$(this).val(a.inputs[b])}),$("option[value="+a.targetState.id+"]",c).prop("selected",!0),$("td.transition-output input",c).each(function(b){$(this).val(a.outputs[b])}),this.showNonDeterministicTransitions(a.sourceState),this.scale(),this.scrollTo(c)},beforeRemoveTransition:function(a,b){var c=b.getIndex(),d=this.getRowsForState(b.sourceState);if(c>0)d[c].remove();else{var e=$("td.source-state-name",d);e.nextAll().remove(),e.after(d.slice(1,2).children()),d.slice(1,2).remove()}$("td.remove-state, td.source-state-name",d.first()).attr("rowspan",d.length-1)},afterRemoveTransition:function(a,b){this.showNonDeterministicTransitions(b.sourceState),this.scale()},showNonDeterministicTransitions:function(a){for(var b=0,c=a.outgoingTransitions.length;c>b;b++){var d=a.outgoingTransitions[b],e=d.getIndex(),f=this.getRowsForState(a).slice(e,e+1);d.isNonDeterministic()?f.addClass("error"):f.removeClass("error")}},currentStateChanged:function(a,b){if($("tr",this.root).removeClass("current"),b){var c=this.getRowsForState(b);c.addClass("current"),this.scrollTo(c)}}})}),namespace("automata.view",function(a){"use strict";a.ControlView=a.View.create().augment({init:function(b,c){return a.View.init.call(this,b,c),b.addListener("start",this.start,this).addListener("pause",this.pauseOrStop,this).addListener("stop",this.pauseOrStop,this),this.panes=["#world-view","#table-view","#diagram-view"],this},render:function(){this.playButton=$("#control-play",this.container);var a=this;this.playButton.click(function(){a.model.isRunning?a.model.pause():(a.updateTimeStep(),a.model.start())}),$("#control-stop",this.container).click(function(){a.model.stop()}),$("#control-left",this.container).click(function(){a.moveLeft()}),$("#control-right",this.container).click(function(){a.moveRight()}),$("#control-speed",this.container).val(10-10*(this.model.timeStep-this.model.timeStepMin)/(this.model.timeStepMax-this.model.timeStepMin)).change(function(){a.updateTimeStep()}),$("#control-help",this.container).click(function(){a.model.fire("help")})},start:function(){this.playButton.addClass("running").html('<i class="fa fa-pause"></i>')},pauseOrStop:function(){this.playButton.removeClass("running").html('<i class="fa fa-play"></i>')},updateTimeStep:function(){var a=parseInt($("#control-speed",this.container).val());this.model.timeStep=this.model.timeStepMin+(this.model.timeStepMax-this.model.timeStepMin)*(10-a)/10},moveLeft:function(){var a=this.panes.pop();$(a).attr("class","entering-left-pane"),this.panes.unshift(a);var b=this;setTimeout(function(){$(b.panes[0]).attr("class","left-pane"),$(b.panes[1]).attr("class","right-pane"),$(b.panes[2]).attr("class","leaving-right-pane")},20)},moveRight:function(){$(this.panes[2]).attr("class","entering-right-pane"),this.panes.push(this.panes.shift());var a=this;setTimeout(function(){$(a.panes[0]).attr("class","left-pane"),$(a.panes[1]).attr("class","right-pane"),$(a.panes[2]).attr("class","leaving-left-pane")},20)}})}),namespace("automata.view",function(a){"use strict";a.HelpView=a.View.create().augment({init:function(b,c){return a.View.init.call(this,b,c),b.addListener("help",this.show,this),this},render:function(){var a=this;$("button",this.container).click(function(){a.hide()})},show:function(){this.container.attr("class","visible")},hide:function(){this.container.removeClass("visible")}})}),namespace("automata.view",function(a){"use strict";a.ScoreView=a.View.create().augment({templates:{main:"templates/ScoreView-main.tpl.html"},init:function(b,c){return a.View.init.call(this,b,c),b.addListener("done",this.show,this),this},show:function(a,b){this.container.empty(),$(this.renderTemplate("main",b)).appendTo(this.container),this.container.attr("class","visible");var c=this;$("button",this.container).click(function(){c.hide()})},hide:function(){this.container.removeClass("visible")}})}),namespace("automata.view",function(a){"use strict";var b=20,c=6,d=3,e=6,f=6,g=1.05,h=.01,i=.9;a.Diagram=a.View.create().augment({templates:{main:"templates/Diagram-main.tpl.svg"},init:function(b,c){return a.View.init.call(this,b,c),this.model=b,this.stateViews=[],this.stateViewsById={},this.transitionViews=[],this.transitionViewsById={},this.transitionViewsByStates={},this.x=0,this.y=0,this.zoom=1,b.addListener("createState",this).addListener("afterRemoveState",this).addListener("createTransition",this).addListener("afterRemoveTransition",this).addListener("currentStateChanged",this),this},toStorable:function(){var a={x:this.x,y:this.y,zoom:this.zoom,states:{},transitions:{}};for(var b in this.stateViewsById){var c=this.stateViewsById[b];a.states[b]={x:c.x,y:c.y}}for(var d in this.transitionViewsById){var e=this.transitionViewsById[d];a.transitions[d]={x:e.x,y:e.y}}return a},fromStorable:function(a,b){this.x=a.x,this.y=a.y,this.zoom=a.zoom,this.updateViewbox();for(var c in a.states)c in b&&b[c].id in this.stateViewsById&&this.putStateView(b[c],a.states[c].x,a.states[c].y);for(var d in a.transitions)d in b&&b[d].id in this.transitionViewsById&&this.putTransitionHandle(b[d],a.transitions[d].x,a.transitions[d].y);return this},createState:function(a,b){b.addListener("changed",this.updateState,this),this.createStateView(b),this.layout()},afterRemoveState:function(a,b){var c=this.stateViewsById[b.id];c.group.remove(),this.stateViews.splice(this.stateViews.indexOf(c),1),delete this.stateViewsById[b.id],this.layout()},updateState:function(a){this.updateStateView(a),this.layout()},createTransition:function(a,b){b.addListener("changed",this.updateTransition,this);var c=this.getViewIdByStates(b);if(c in this.transitionViewsByStates){var d=this.transitionViewsById[b.id]=this.transitionViewsByStates[c];d.transitions.push(b)}else this.createTransitionView(b);this.updateStateView(b.sourceState),this.layout()},afterRemoveTransition:function(a,b){this.removeTransitionViewIfUnused(b),this.updateStateView(b.sourceState),this.layout()},updateTransition:function(a){var b=this.getViewIdByStates(a),c=this.transitionViewsByStates[b],d=this.transitionViewsById[a.id];c!==d&&(this.removeTransitionViewIfUnused(a),c?(this.transitionViewsById[a.id]=c,c.transitions.push(a)):c=this.createTransitionView(a),d=c),this.updateStateView(a.sourceState);for(var e=0,f=a.sourceState.outgoingTransitions.length;f>e;e++)this.updateTransitionText(a.sourceState.outgoingTransitions[e]);this.layout()},layoutStep:function(){function a(a,b,c,d,e,f,g,h){var i=e-b,j=f-c,k=Math.sqrt(i*i+j*j);if(0!==k){var l=h*(k-g)/k;a.vx+=l*i,a.vy+=l*j,d.vx-=l*i,d.vy-=l*j}}for(var b=!0,c=0,d=this.stateViews.length,f=this.transitionViews.length,g=0;d>g;g++){var j=this.stateViews[g];j.vx*=i,j.vy*=i;var k=2.5*(j.width+j.height);k>c&&(c=k)}for(var l=0;f>l;l++){var m=this.transitionViews[l];m.vx*=i,m.vy*=i}for(var n=0;d>n;n++){for(var o=this.stateViews[n],p=o.x+o.width/2,q=o.y+o.height/2,r=n+1;d>r;r++){var s=this.stateViews[r];a(o,p,q,s,s.x+s.width/2,s.y+s.height/2,c,h)}for(var t=0;f>t;t++){var u=this.transitionViews[t];u.transitions[0].sourceState===o.state&&u.transitions[0].targetState===o.state?a(o,p,q,u,u.x,u.y,o.width,h):u.transitions[0].sourceState===o.state||u.transitions[0].targetState===o.state?a(o,p,q,u,u.x,u.y,o.width+o.height,h):a(o,p,q,u,u.x,u.y,c,h/100)}(o.vx>=.5||o.vy>=.5)&&(b=!1),this.putStateView(o.state,o.x+o.vx,o.y+o.vy)}for(var v=0;f>v;v++){for(var w=this.transitionViews[v],x=v+1;f>x;x++){var y=this.transitionViews[x];w.transitions[0].sourceState===y.transitions[0].sourceState&&w.transitions[0].targetState===y.transitions[0].targetState||w.transitions[0].sourceState===y.transitions[0].targetState&&w.transitions[0].targetState===y.transitions[0].sourceState?a(w,w.x,w.y,y,y.x,y.y,Math.max((w.width+y.width+w.height+y.height)/2,4*e),2*h):a(w,w.x,w.y,y,y.x,y.y,c,h/100)}(w.vx>=.5||w.vy>=.5)&&(b=!1),this.putTransitionHandle(w.transitions[0],w.x+w.vx,w.y+w.vy)}return b&&this.fire("changed"),!b},layout:function(){function a(){b.layoutStep()&&window.requestAnimationFrame(a)}var b=this;window.requestAnimationFrame(a)},render:function(){function a(a){0===a.button&&(h=k.x,i=k.y,j=a,$(document.documentElement).mousemove(b),$(document.documentElement).mouseup(c),a.preventDefault(),a.stopPropagation())}function b(a){k.x=h-(a.clientX-j.clientX)/k.zoom,k.y=i-(a.clientY-j.clientY)/k.zoom,k.updateViewbox(),a.preventDefault(),a.stopPropagation()}function c(a){0===a.button&&(k.fire("changed"),$(document.documentElement).off("mouseup",c),$(document.documentElement).off("mousemove",b),a.preventDefault(),a.stopPropagation())}function d(a){a||(a=window.event);var b=0;a.wheelDelta?b=a.wheelDelta:a.detail&&(b=-a.detail);var c=1;b>0?c=1/g:0>b&&(c=g),k.zoom/=c,k.x+=k.getWidth()*(1-c)/2,k.y+=k.getHeight()*(1-c)/2,k.updateViewbox(),a.stopPropagation(),a.preventDefault()}function e(a){var b=k.getWidth(),c=k.getHeight(),d=k.paper.node.getBBox();k.zoom=Math.min(b/d.width,c/d.height),k.x=d.x-(b/k.zoom-d.width)/2,k.y=d.y-(c/k.zoom-d.height)/2,k.updateViewbox(),a.preventDefault(),a.stopPropagation()}var f=Snap.parse(this.renderTemplate("main",this.model));this.container.append(f.node),this.paper=Snap("svg.automata-Diagram"),this.resetView=this.paper.select("#reset"),this.shadow=this.paper.select("#state-shadow");var h,i,j,k=this;this.paper.mousedown(a).dblclick(e),this.paper.node.addEventListener("DOMMouseScroll",d,!1),this.paper.node.onmousewheel=d},getWidth:function(){return this.container.width()},getHeight:function(){return this.container.height()},updateViewbox:function(){var a=this.getWidth(),b=this.getHeight();this.paper.attr({viewBox:[this.x,this.y,a/this.zoom,b/this.zoom]})},getViewIdByStates:function(a){return a.sourceState.id+"-"+a.targetState.id},createStateView:function(a){var c=this.stateViewsById[a.id]={state:a,x:0,y:0,vx:0,vy:0,width:0,height:0,rect:this.paper.rect(0,0,0,0,b,b).attr({filter:this.shadow}),name:this.paper.text(0,0,"State name"),actions:this.paper.text(0,0,"Moore actions"),separator:this.paper.line(0,0,0,0),group:this.paper.g().attr({"class":"state"})};this.stateViews.push(c),c.group.add(c.rect,c.name,c.actions,c.separator);var e=c.name.getBBox();c.name.attr({y:e.height});var f=c.actions.getBBox();c.actions.attr({y:e.height+f.height+2*d}),c.separator.attr({y1:e.height+2*d,y2:e.height+2*d}),c.height=e.height+f.height+4*d,c.rect.attr({height:c.height}),this.updateStateView(a);var g=this.x+(this.getWidth()/this.zoom-c.width)*Math.random(),h=this.y+(this.getHeight()/this.zoom-c.height)*Math.random();this.putStateView(a,g,h),this.setDraggable(c,"group",function(b,c){this.putStateView(a,b,c);for(var d=0,e=a.outgoingTransitions.length;e>d;d++){var f=a.outgoingTransitions[d];f.targetState===a&&(this.updateTransitionHandle(f),this.updateTransitionPath(f))}})},setDraggable:function(a,b,c){var d,e;a[b].drag(function(a,b,f,g,h){c.call(this,d+a/this.zoom,e+b/this.zoom),h.stopPropagation(),h.preventDefault()},function(b,c,f){d=a.x,e=a.y,f.stopPropagation(),f.preventDefault()},function(a){this.layout(),a.stopPropagation(),a.preventDefault()},this,this,this)},putStateView:function(a,b,c){var d=this.stateViewsById[a.id];d.x=b,d.y=c,d.group.transform("translate("+b+","+c+")");for(var e=0,f=a.incomingTransitions.length;f>e;e++)this.updateTransitionPath(a.incomingTransitions[e]);for(var g=0,h=a.outgoingTransitions.length;h>g;g++)this.updateTransitionPath(a.outgoingTransitions[g]);return a===this.model.states[0]&&this.updateResetView(),this},updateStateView:function(a){var b=this.stateViewsById[a.id];b.name.attr({text:a.name||" "}),b.actions.attr({text:a.getMooreActions().join(", ")||" "}),b.width=Math.max(b.name.node.getComputedTextLength(),b.actions.node.getComputedTextLength())+2*c,b.name.attr({x:b.width/2}),b.actions.attr({x:b.width/2}),b.rect.attr({width:b.width}),b.separator.attr({x2:b.width}),a===this.model.states[0]&&this.updateResetView()},updateResetView:function(){var a=this.model.states[0];if(a){var b=this.stateViewsById[a.id];this.resetView.transform("translate("+(b.x+b.width/2-4*e)+","+(b.y-4*e)+")")}},createTransitionView:function(a){var b=this.getViewIdByStates(a),c=this.transitionViewsById[a.id]=this.transitionViewsByStates[b]={transitions:[a],x:0,y:0,vx:0,vy:0,width:0,height:0,handle:this.paper.circle(0,0,e).attr({filter:this.shadow}),path:this.paper.path().attr({markerEnd:this.paper.select("#arrow-head")}),text:this.paper.text(""),textHandleGroup:this.paper.g(),group:this.paper.g().attr({"class":"transition"})};this.transitionViews.push(c),c.textHandleGroup.add(c.text,c.handle),c.group.add(c.path,c.textHandleGroup),this.updateTransitionHandle(a),this.updateTransitionPath(a),this.setDraggable(c,"handle",function(b,c){this.putTransitionHandle(a,b,c)})},putTransitionHandle:function(a,b,c){var d=this.transitionViewsById[a.id];d.x=b,d.y=c,d.handle.attr({cx:b,cy:c}),this.updateTransitionPath(a),this.moveTransitionText(a)},updateTransitionHandle:function(a){var b=this.transitionViewsById[a.id],c=this.stateViewsById[a.sourceState.id],d=this.stateViewsById[a.targetState.id];a.sourceState===a.targetState?(b.x=c.x+c.width+c.height,b.y=c.y+c.height/2):(b.x=(c.x+c.width/2+d.x+d.width/2)/2,b.y=(c.y+c.height/2+d.y+d.height/2)/2),b.handle.attr({cx:b.x,cy:b.y}),this.moveTransitionText(a)},updateTransitionText:function(a){var b=this.transitionViewsById[a.id];b.text.selectAll("tspan.term").forEach(function(a){a.remove()});var c=a.sourceState.stateMachine.world.sensors,d=a.sourceState.stateMachine.world.actuators,e=a.sourceState.getTransitionsToState(a.targetState),f=a.sourceState.getMooreActions();b.height=0,b.width=0;for(var g=!1,h=0,i=e.length;i>h;h++){var j=e[h],k=this.paper.el("tspan").attr({"class":"term"}),l=parseFloat(getComputedStyle(k.node,null).getPropertyValue("font-size"));g&&(l*=1.5,k.attr({"#text":"+"})),k.attr({dy:l+"px"});for(var m=!1,n=0,o=j.inputs.length;o>n;n++){var p=j.inputs[n];if("-"!==p){var q=this.paper.el("tspan").attr({"class":"automata-bool-"+p});q.attr({"#text":c[n].name}),m&&k.add(this.paper.el("tspan").attr({"#text":"."})),m=!0,k.add(q)}}for(var r=!1,s=0,t=j.outputs.length;t>s;s++)"1"===j.outputs[s]&&-1===f.indexOf(d[s].name)&&(r?k.add(this.paper.el("tspan").attr({"#text":", "})):(k.add(this.paper.el("tspan").attr({"#text":" / "})),r=!0),k.add(this.paper.el("tspan").attr({"#text":d[s].name})));if(m||r){b.text.add(k);var u=k.node.getComputedTextLength();u>b.width&&(b.width=u),b.height+=l,g=!0}}this.moveTransitionText(a)},moveTransitionText:function(a){var b=this.transitionViewsById[a.id],c=b.x+2*e,d=b.y-b.height/2;b.text.attr({x:c,y:d}),b.text.selectAll("tspan.term").attr({x:c})},updateTransitionPath:function(a){function b(a,b,c){var d=a.x<c.x?b.x:b.x+b.width,e=(a.y-c.y)*(d-c.x)/(a.x-c.x)+c.y;return(e<b.y||e>b.y+b.height)&&(e=a.y<c.y?b.y:b.y+b.height,d=(a.x-c.x)*(e-c.y)/(a.y-c.y)+c.x),{x:d,y:e}}var c,d=this.transitionViewsById[a.id],e=this.stateViewsById[a.sourceState.id],g=this.stateViewsById[a.targetState.id],h={x:e.x+e.width/2,y:e.y+e.height/2},i={x:g.x+g.width/2,y:g.y+g.height/2};c=a.sourceState!==a.targetState?{x:(i.x-h.x)/f,y:(i.y-h.y)/f}:{x:-d.y+h.y,y:d.x-h.x};var j={x:d.x-c.x,y:d.y-c.y},k={x:d.x+c.x,y:d.y+c.y},l=b(j,e,h),m=b(k,g,i);d.path.attr({d:"M"+l.x+","+l.y+"Q"+j.x+","+j.y+","+d.x+","+d.y+"Q"+k.x+","+k.y+","+m.x+","+m.y})},removeTransitionViewIfUnused:function(a){var b=this.transitionViewsById[a.id];if(b.transitions.splice(b.transitions.indexOf(a),1),0===b.transitions.length){b.group.remove(),this.transitionViews.splice(this.transitionViews.indexOf(b),1);for(var c in this.transitionViewsByStates)if(this.transitionViewsByStates[c]===b){delete this.transitionViewsByStates[c];break}}delete this.transitionViewsById[a.id]},currentStateChanged:function(a,b){this.paper.selectAll(".state").attr({"class":"state"}),b&&this.stateViewsById[b.id].group.attr({"class":"state current"})}})}),namespace("automata.storage",function(a,b){"use strict";function c(){try{return"localStorage"in b&&null!==b.localStorage}catch(a){return!1}}a.LocalStorage=automata.model.Object.create({init:function(){return this.sources=[],this.mapping={},this},addSource:function(a,b){return this.sources.push({key:a,source:b}),b.addListener("changed",this.save,this),this},load:function(){var a=!1;if(c()){var d,e=this.sources.length;for(d=0;e>d;d++)this.sources[d].source.removeListener("changed",this.save,this);for(d=0;e>d;d++){var f=this.sources[d];f.key in b.localStorage&&(console.log("Loading: "+f.key),f.source.fromStorable(JSON.parse(b.localStorage[f.key]),this.mapping),a=!0)}for(d=0;e>d;d++)this.sources[d].source.addListener("changed",this.save,this)}return a},save:function(a){if(c())for(var d=0,e=this.sources.length;e>d;d++){var f=this.sources[d];("undefined"==typeof a||f.source===a)&&(console.log("Saving: "+f.key),b.localStorage[f.key]=JSON.stringify(a.toStorable()))}},toJSON:function(){for(var a={},b=0,c=this.sources.length;c>b;b++){var d=this.sources[b];a[d.key]=d.source.toStorable()}return JSON.stringify(a)},fromJSON:function(a){var b,c=JSON.parse(a),d=this.sources.length;for(b=0;d>b;b++)this.sources[b].source.removeListener("changed",this.save,this);for(b=0;d>b;b++){var e=this.sources[b];e.key in c&&(console.log("Importing: "+e.key),e.source.fromStorable(c[e.key],this.mapping))}for(b=0;d>b;b++)this.sources[b].source.addListener("changed",this.save,this);return this},toBlobURL:function(){var a=new Blob([this.toJSON()],{type:"application/json"});return URL.createObjectURL(a)},fromFile:function(a){var b=new FileReader,c=this;return b.onload=function(){c.fromJSON(this.result)},b.readAsText(a),this},toBase64:function(){return b.btoa(b.unescape(encodeURIComponent(this.toJSON())))},fromBase64:function(a){return this.fromJSON(decodeURIComponent(b.escape(b.atob(a))))}})}),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/Diagram-main.tpl.svg"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<svg class="automata-Diagram">\n    <defs>\n        <marker id="arrow-head"\n                viewBox="0 0 10 10" refX="10" refY="5"\n                markerWidth="10" markerHeight="10"\n                markerUnits="strokeWidth"\n                orient="auto">\n            <path d="M0,0 L10,5 L0,10 L2,5 z" />\n        </marker>\n        <filter id="state-shadow"\n                x="-25%" y="-20%" width="150%" height="150%">\n            <feGaussianBlur in="SourceAlpha" stdDeviation="3" />\n            <feOffset dx="0" dy="2" />\n            <feComponentTransfer>\n                <feFuncA type="linear" slope="0.4" />\n            </feComponentTransfer>\n            <feMerge>\n                <feMergeNode />\n                <feMergeNode in="SourceGraphic" />\n            </feMerge>\n        </filter>\n    </defs>\n    <g id="reset" class="transition">\n        <path marker-end="url(#arrow-head)" d="M6,6 c6,0 18,6 18,18" />\n        <circle r="6" cx="6" cy="6" filter="url(#state-shadow)" />\n    </g>\n</svg>',
e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/ScoreView-main.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<div>\n    <div class="score-status">\n        ',"success"==d.contextOrFrameLookup(b,c,"status")?h+=' <i class="fa fa-thumbs-up"></i>\n        ':"warning"==d.contextOrFrameLookup(b,c,"status")?h+=' <i class="fa fa-warning"></i>\n        ':"error"==d.contextOrFrameLookup(b,c,"status")&&(h+=' <i class="fa fa-thumbs-down"></i>\n        '),h+='\n    </div>\n    <div class="score-message">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"message"),a.autoesc),h+='</div>\n    <div>\n        <button title="Close"><i class="fa fa-times"></i></button>\n    </div>\n</div>',e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/TransitionTable-main.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<table class="automata-TransitionTable">\n    <tr>\n        <th></th>\n        <th>Source state</th>\n        <th></th>\n        ',c=c.push();var i=d.memberLookup(d.contextOrFrameLookup(b,c,"world"),"sensors",a.autoesc);if(i)for(var j=0;j<i.length;j++){var k=i[j];c.set("s",k),h+='\n            <th title="',h+=d.suppressValue(d.memberLookup(k,"desc",a.autoesc),a.autoesc),h+='">',h+=d.suppressValue(d.memberLookup(k,"name",a.autoesc),a.autoesc),h+="</th>\n        "}c=c.pop(),h+="\n        <th>&rarr;</th>\n        ",c=c.push();var l=d.memberLookup(d.contextOrFrameLookup(b,c,"world"),"actuators",a.autoesc);if(l)for(var m=0;m<l.length;m++){var n=l[m];c.set("a",n),h+='\n            <th title="',h+=d.suppressValue(d.memberLookup(n,"desc",a.autoesc),a.autoesc),h+='">',h+=d.suppressValue(d.memberLookup(n,"name",a.autoesc),a.autoesc),h+="</th>\n        "}c=c.pop(),h+='\n        <th>Target state</th>\n    </tr>\n    <tr>\n        <td class="create-state" colspan="',h+=d.suppressValue(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"world"),"sensors",a.autoesc),"length",a.autoesc)+d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"world"),"actuators",a.autoesc),"length",a.autoesc)+5,a.autoesc),h+='">\n            <button title="Create a state"><i class="fa fa-plus-circle"></i></button>\n        </td>\n    </tr>\n</table>\n',e(null,h)}catch(o){e(d.handleError(o,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/TransitionTable-state.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{if(h+='<tr class="state-',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"state"),"id",a.autoesc),a.autoesc),h+='">\n    <td class="remove-state"><button title="Remove this state"><i class="fa fa-minus-circle"></i></button></td>\n    <td class="source-state-name">\n        <input type="text" size="10" value="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"state"),"name",a.autoesc),a.autoesc),h+='">\n        ',d.memberLookup((f=4,g=30,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"model"),"getStateVars",a.autoesc),'model["getStateVa"]',[])),"length",a.autoesc)){h+='\n            <table class="state-encoding">\n                <tr>\n                    ',c=c.push();var i=(f=7,g=51,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"model"),"getStateVars",a.autoesc),'model["getStateVa"]',[]));if(i)for(var j=0;j<i.length;j++){var k=i[j];c.set("name",k),h+="\n                        <th>s<sub>",h+=d.suppressValue(k,a.autoesc),h+="</sub></th>\n                    "}c=c.pop(),h+="\n                </tr>\n                <tr>\n                    ",c=c.push();var l=d.memberLookup(d.contextOrFrameLookup(b,c,"state"),"encoding",a.autoesc);if(l)for(var m=0;m<l.length;m++){var n=l[m];c.set("value",n),h+='\n                        <td><input type="button" class="automata-bool" value="',h+=d.suppressValue(n,a.autoesc),h+='"></td>\n                    '}c=c.pop(),h+="\n                </tr>\n            </table>\n        "}h+='\n    </td>\n    <td class="create-transition" colspan="',h+=d.suppressValue(d.memberLookup(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"model"),"world",a.autoesc),"sensors",a.autoesc),"length",a.autoesc)+d.memberLookup(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"model"),"world",a.autoesc),"actuators",a.autoesc),"length",a.autoesc)+3,a.autoesc),h+='">\n        <button title="Create a transition"><i class="fa fa-plus-circle"></i></button>\n    </td>\n</tr>\n',e(null,h)}catch(o){e(d.handleError(o,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/TransitionTable-transition.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<td class="remove-transition"><button title="Remove this transition"><i class="fa fa-minus-circle"></i></button></td>\n',c=c.push();var i=d.memberLookup(d.contextOrFrameLookup(b,c,"transition"),"inputs",a.autoesc);if(i)for(var j=0;j<i.length;j++){var k=i[j];c.set("value",k),h+='\n    <td class="transition-input"><input type="button" class="automata-bool" value="',h+=d.suppressValue(k,a.autoesc),h+='"></td>\n'}c=c.pop(),h+='\n<td class="arrow">&rarr;</td>\n',c=c.push();var l=d.memberLookup(d.contextOrFrameLookup(b,c,"transition"),"outputs",a.autoesc);if(l)for(var m=0;m<l.length;m++){var n=l[m];c.set("value",n),h+='\n    <td class="transition-output"><input type="button" class="automata-bool" value="',h+=d.suppressValue(n,a.autoesc),h+='"></td>\n'}c=c.pop(),h+='\n<td class="target-state-name">\n    <select>\n        ',c=c.push();var o=d.memberLookup(d.contextOrFrameLookup(b,c,"model"),"states",a.autoesc);if(o)for(var p=0;p<o.length;p++){var q=o[p];c.set("targetState",q),h+='\n            <option value="',h+=d.suppressValue(d.memberLookup(q,"id",a.autoesc),a.autoesc),h+='"\n                    ',d.memberLookup(q,"id",a.autoesc)==d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"transition"),"targetState",a.autoesc),"id",a.autoesc)&&(h+=" selected "),h+=">\n                ",h+=d.suppressValue(d.memberLookup(q,"name",a.autoesc),a.autoesc),h+="\n            </option>\n        "}c=c.pop(),h+='\n        <option value="#NewState#">New state</option>\n    </select>\n</td>\n',e(null,h)}catch(r){e(d.handleError(r,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/game.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<!doctype html>\n<html>\n    <head>\n        <meta charset="utf-8">\n        <title>Automata</title>\n\n        <meta name="viewport" content="width=device-width, user-scalable=no">\n\n        <link rel="icon" type="image/png" href="icons/32.png" />\n\n        <link rel="stylesheet" href="bower_components/normalize.css/normalize.css">\n        <link rel="stylesheet" href="bower_components/fontawesome/css/font-awesome.css">\n        <link rel="stylesheet" href="css/automata.core.min.css">\n        <link rel="stylesheet" href="css/',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"key"),a.autoesc),h+='.min.css">\n\n        <script src="bower_components/jquery/dist/jquery.min.js"></script>\n        <script src="bower_components/nunjucks/browser/nunjucks-slim.min.js"></script>\n        <script src="bower_components/snap.svg/dist/snap.svg-min.js"></script>\n        <script src="js/automata.core.min.js"></script>\n        <script src="js/',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"key"),a.autoesc),h+='.min.js"></script>\n\n        <script>\n            automata.main(',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"key"),a.autoesc),h+=');\n        </script>\n    </head>\n    <body>\n        <div id="main">\n            <div id="control-view">\n                <span class="group">\n                    <a href="index.html"><i class="fa fa-home"></i></a>\n                </span>\n                <span class="group">\n                    <button id="control-play" title="Play/Pause"><i class="fa fa-play"></i></button>\n                    <button id="control-stop" title="Stop"><i class="fa fa-stop"></i></button>\n                    <label for="control-speed">Speed:</label>\n                    <input type="range" id="control-speed" value="20" min="0" max="10" step="1" title="Speed">\n                </span>\n                <span class="group">\n                    <button id="control-left" title="Show previous pane"><i class="fa fa-chevron-left"></i></button>\n                    <button id="control-right" title="Show next pane"><i class="fa fa-chevron-right"></i></button>\n                </span>\n                <span class="group">\n                    <button id="control-help" title="Help"><i class="fa fa-info-circle"></i></button>\n                </span>\n                <a class="export" download="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"key"),a.autoesc),h+='.json"></a>\n                <input class="import" type="file">\n            </div>\n            <div id="world-view" class="left-pane"></div>\n            <div id="table-view" class="right-pane"></div>\n            <div id="diagram-view" class="hidden"></div>\n            <div id="help-view">\n                <div>\n                    <h1>',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"title"),a.autoesc),h+="</h1>\n                    <div>",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"content"),a.autoesc),h+='</div>\n                </div>\n                <button title="Close"><i class="fa fa-times"></i></button>\n            </div>\n            <div id="score-view"></div>\n        </div>\n    </body>\n</html>\n',e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/index.tpl.html"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<!doctype html>\n<html>\n    <head>\n        <meta charset="utf-8">\n        <title>Automata</title>\n\n        <meta name="viewport" content="width=device-width, user-scalable=no">\n        \n        <link rel="icon" type="image/png" href="icons/32.png">\n        <link rel="stylesheet" href="bower_components/normalize.css/normalize.css">\n        <link rel="stylesheet" href="bower_components/fontawesome/css/font-awesome.css">\n        <link rel="stylesheet" href="css/automata.core.min.css">\n\n        <script src="bower_components/jquery/dist/jquery.min.js"></script>\n        <script src="js/webapp.js"></script>\n    </head>\n    <body>\n        <div id="main">\n            <div id="control-view">\n                <span class="group">Automata</span>\n            </div>\n            <div id="games-menu">\n                ',c=c.push();var i=d.contextOrFrameLookup(b,c,"categories");if(i)for(var j=0;j<i.length;j++){var k=i[j];c.set("cat",k),h+="\n                    <h1>",h+=d.suppressValue(d.memberLookup(k,"title",a.autoesc),a.autoesc),h+="</h1>\n                    \n                    <ul>\n                        ",c=c.push();var l=d.memberLookup(k,"games",a.autoesc);if(l)for(var m=0;m<l.length;m++){var n=l[m];c.set("game",n),h+='\n                            <li><a href="',h+=d.suppressValue(d.memberLookup(n,"key",a.autoesc),a.autoesc),h+='.html"><img src="icons/',h+=d.suppressValue(d.memberLookup(n,"key",a.autoesc),a.autoesc),h+='.svg">',h+=d.suppressValue(d.memberLookup(n,"title",a.autoesc),a.autoesc),h+="</a></li>\n                        "}c=c.pop(),h+="\n                    </ul>\n                "}c=c.pop(),h+="\n            </div>\n        </div>\n    </body>\n</html>\n",e(null,h)}catch(o){e(d.handleError(o,f,g))}}return{root:a}}()}();